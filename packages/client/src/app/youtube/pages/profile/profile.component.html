<div *ngIf="loadingService.isLoading; then loaders else loaded"></div>

<ng-template #loaders>
  <app-loaders></app-loaders>
</ng-template>

<ng-template #loaded>
  <div class="profile-container">
    <div>
      <h2 class="title profile-title">Profile</h2>
      <div *ngIf="channelAlias">
        <a class="channel-redirect" [routerLink]="['../../channel', channelAlias]">
          <mat-icon matSuffix class="channel-redirect__icon">smart_display</mat-icon>
          <p class="channel-redirect__text">Channel</p>
        </a>
      </div>
    </div>

    <div *ngIf="isOwner | async; then owner else member"></div>

    <ng-template #owner>
      <form class="profile" [formGroup]="profileForm" (submit)="editProfile($event)">
        <ng-container *ngTemplateOutlet="profileData"></ng-container>
        <button
          type="submit"
          mat-raised-button class="submit-btn"
          color="primary"
          [ngClass]="{ 'disabled-btn': profileForm.invalid }"
        >Edit</button>
      </form>
    </ng-template>

    <ng-template #member>
      <div class="profile">
        <ng-container *ngTemplateOutlet="profileData"></ng-container>
      </div>
    </ng-template>


    <ng-template #profileData>
      <div class="avatar-username-container">
        <div mat-card-avatar class="profile-avatar">
          <input type="file" accept="image/*" (change)="uploadAvatar($event)"/>
          <div *ngIf="avatarUrlSubject | async; then image else placeholder"></div>
          <ng-template #image>
            <img [src]="avatarUrlSubject | async" alt="avatar" class="profile-avatar__avatar">
          </ng-template>
          
          <ng-template #placeholder>
            <mat-icon matSuffix class="profile-avatar__placeholder">perm_identity</mat-icon>
          </ng-template>
        </div>
        <div class="editable-field">
          <p class="editable-field__label">Username</p>
          <input type="text" class="editable-field__input" [formControl]="username">
          <mat-error *ngIf="username.invalid">Should be set of less than 20 letters and digits</mat-error>
        </div>
      </div>
      <div class="editable-field">
        <p class="editable-field__label">First Name</p>
        <input type="text" class="editable-field__input" [formControl]="firstName">
        <mat-error *ngIf="firstName.invalid">Should be set of less than 20 letters</mat-error>
      </div>
      <div class="editable-field">
        <p class="editable-field__label">Last Name</p>
        <input type="text" class="editable-field__input" [formControl]="lastName">
        <mat-error *ngIf="lastName.invalid">Should be set of less than 20 letters</mat-error>
      </div>
    </ng-template>
  </div>
</ng-template>
